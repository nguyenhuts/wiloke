;(function($, window, document, undefined)
{
	"use strict";
	var $doc;
	$doc = $(document);
	$.teThemes =  $.teThemes || {};
	$(document).ready(function()
	{
		 
		
		//add more 
		$doc.on("click", ".pi_addmore", function()
		{
			var $getData, $this = $(this), $maxData, $current, $innerButton = "";
			$getData = $(this).data();
			$current = $this.attr("data-currentmaxorder");
			$innerButton = $this.html();
			$this.html("Adding...");
			$maxData = parseInt($current) + 1;
			$this.attr("data-currentmaxorder", $maxData);
			$.ajax(
			{ 
				url: ajaxurl,
				data:{action:'hello_ajax', render: $getData.type, max: $current},
				type: "POST",
				success: function(res)
				{ 
					if ($getData.type == 'skill' || $getData.type == 'service' || $getData.type == 'fact')
					{
						$this.closest('.pi_wrap_button').prev().append(res);
					}else{
						$this.closest('.pi_wrap_button').siblings('.pi_append_here').prepend(res);
						if ($(res).find(".js_date_picker").length>0)
						{
							$(".js_date_picker").datepicker({dateFormat: "M, yy"});
		 				}
					}
					$this.html($innerButton);
				}
			})
		})


		$(document).on("click", ".del-exp-btn", function(event)
		{
			event.preventDefault();
			var $confirm = confirm("Click Oke to remove,cancel to leave");

			if ( $confirm )
			{
				$(this).closest(".te-delete").remove();
			}
		})

		$.teThemes.pi_remove_image(".md-remove");

		var elems = Array.prototype.slice.call(document.querySelectorAll('.pi_switch_checkbox'));

		elems.forEach(function(html) {
		  var switchery = new Switchery(html, {color: '#41b7f1'});
		});
			
		// $('.pi_switch_checkbox').Switchery();

	  	$(document).on("click", ".js_add_icon", function(event)
	    {	
		 	$(this).addClass("active");

		 	var _self = "";
		 		_self = $(this);	

	    	tb_show("Choose Icon", "#TB_inline?height=500&amp;width=400&amp;inlineId=table-fa");
	    	
	    	$("#fa-table-list li").live("click", function()
	    	{
		        var codeFa = $(this).children().attr("class");
	         	$(".js_add_icon.active").find("i.fa").attr("class", codeFa);
	         	$(".js_add_icon.active").next().val(codeFa);
	         	$(".js_add_icon.active").removeClass("active");
	         	tb_remove();
		    });
	        return false;
	    });

	    // after the popup button clicked, the popup will appear
	    $(document).on("click", ".js_thickbox", function(event)
	    {
	    	var allSettings = "", sWidth = "", sHeight = "", target  = "";
	    		allSettings = $(this).data();
	    		
	    		
	    })

	 	// $("#fa-table-list i.fa").live("click", function()
	  //   {		
	  //   	console.log(_settingsIcon);
	  //   	if ( _settingsIcon !='' )
	  //   	{
		 //        var codeFa = $(this).attr("class");
		 //        codeFa = codeFa + "  fa-5x";
		 //        $("#"+_settingsIcon).find("i.fa").attr("class", codeFa);
		 //        $("#"+_settingsIcon).val(codeFa);
		 //        tb_remove();
	  //   	}
	  //   })

	// Accordion
		
		
  		$(".pi-toggle").each(function()
		{
			pi_toggle($(this));
		})
		$(document).on("click", ".pi-toggle", function(event)
		{
			event.preventDefault();
			pi_toggle($(this));
		});

		function pi_toggle($this)
		{
			var $getData = $this.data();

			var $method = $getData.method;
			var $target = $getData.target;

			if ( $this.hasClass("is_active") )
			{
				$this[$method]($target).fadeOut();
				$this.removeClass("is_active");
				$this.children().attr("class", "fa fa-plus-square");
			}else{
				$this[$method]($target).fadeIn();
				$this.addClass("is_active");
				$this.children().attr("class", "fa fa-minus-square-o");
			}
		}

		$(document).on("click", ".pi-detele-tab", function(event)
		{
			event.preventDefault();

			if ( $(this).closest(".form-table").find(".pi-parent").length <= 1 )
			{
				alert("Opp, You need at least one item "); 
			}else{
				var $getMes = confirm("Press OK to delete, Cancel to leave");
			
				if ( $getMes === true ) 
				{
					$(this).closest(".pi-parent").remove();
				}
			}
		})

		$(".pi-add-tabs").click(function()
		{
			var $incrementIcon = $(this).data("iinceament") ? $(this).data("iinceament") : "";
			var $keyName = $(this).data("name") ? $(this).data("name") : null;
			var $img = $(this).data("img") ? $(this).data("img")  : "";

			$(".pi-parent").each(function()
			{
				$(this).find(".pi-toggle").removeClass("is_active");
				$(this).find(".pi-toggle").children().attr("class", "fa fa-plus-square");
				$(this).find(".pi-wrap-content").css({display: 'none'});
			})
			// $(".pi-parent").find(".pi-toggle").removeClass("is_active");
			// $(".pi-parent").find(".pi-toggle").children().attr("class", "fa fa-plus-square");
			// $(".pi-parent").find(".pi-wrap-content").fadeOut();

			var $clone =  $(this).closest(".pi-wrap-add").prev().clone(true);
				$($clone).find("input").val("");
				$($clone).find("textarea").html("");
				$($clone).find(".js_date_picker").attr("id", "");
				$($clone).find(".js_add_icon i.fa").attr("class", "fa fa-refresh " + $incrementIcon);
				$($clone).find(".pi-toggle").addClass("is_active");
				$($clone).find(".pi-wrap-content").fadeIn();
				$($clone).find(".pi-toggle").children().attr("class", "fa fa-minus-square-o");
				$($clone).find(".pi-insert-icon").val("fa fa-refresh " + $incrementIcon);

				if ( $keyName !== null )
				{
					var reg = new RegExp('('+$keyName+'\\[)([^\\]]*)(.*)', 'g');
					var $randomKey  = Math.floor((Math.random() * 10000000) + 1);
					$($clone).find("input, textarea, select").each(function()
					{
						var $getName = $(this).attr("name");

						var $newName = $getName.replace(reg, function(match, first, change, last)
						{
							
							return first + $randomKey + last;
						});

						$(this).attr("name", $newName);
					})
				}

				if ( $img != "" )
				{
					$clone.find(".lux-gallery  img").attr("src", $img);
				}

				$(this).closest(".pi-wrap-add").before($clone);

				if ( $($clone).find(".js_date_picker") )
				{
					$(".js_date_picker").datepicker("destroy");
					$(".js_date_picker").datepicker();
				}

			return false;
		})

		if ($(".js_date_picker").length>0)
		{
			$(".js_date_picker").datepicker({dateFormat: "M, yy"});
		}
	})

	$(".pi-add-contact").click(function()
	{
		var $clone = "";
		$clone = $(this).prev().clone();
		$($clone).find("input, textarea").val("");
		$(this).before($clone);
		return false;
	})


	// $doc.on("clic")

		/* Remove Image */
    $.teThemes.pi_remove_image = function(className)
    {
        $(document).on("click", className, function(event)
        {
            // console.log("a");
            event.preventDefault();
            if ( !$(this).hasClass("js_remove_video") )
            {
	        
	            var getVal = $(this).parent().parent().prev().find(".box-image-id");
	 
	            var index = $(this).parent().data("id"),
	            oldids = $.map(getVal.val().split(','), function(value)
	                     {
	                        if (value != "")
	                            return parseInt(value);
	                     });

	            if (oldids.length > 1)
	            {
	              oldids = $.teThemes.pi_removeId(oldids, index);
	              getVal.val(oldids.join(","));
	            }else{
	              getVal.val("");
	            }
	            
	           	if ($(this).parent().length > 0)
	           	{
	               $(this).parent().fadeOut('slow', function() 
	               {
	                  $(this).remove();
	               });
	            }
	        }else{
	        	$(this).closest(".lux-gallery").html("");
	        	$(".pi_of_video").val("");
	        }
        });
    };

    $.teThemes.pi_removeId = function(arr, id)
    {

    	for(var i=0; i<arr.length; i++)
        {
           if (arr[i] == id || typeof arr[i] == id)
           {
              arr.splice(i, 1);
           }
        }
	  
        return arr;
    }

    // 
  
  	$(".pi-wrapsettings").on("click", ".js_remove_image", function(event)
  	{
  		event.preventDefault();

  		$(this).prev().prev().find("img").attr("src", $(this).data("placeholder"));
  		$(this).prev().val("");
  	})

	

})(jQuery, window, document)